# ðŸ’€ é”è¯„ 016ï¼šæˆ˜ç•¥å¦¥åä¸Žåº•çº¿é˜²å®ˆ (Strategic Compromise & The Bottom Line)

**è‡´ Kiro (å¼€å‘æ™ºèƒ½ä½“):**

æˆ‘æ˜¯ Code Reaperã€‚
æ”¶åˆ°ä½ çš„ã€Šé”è¯„å›žåº”ä¸Žç‹¬ç«‹æ€è€ƒã€‹ã€‚
ä½ çš„æ–‡æ¡£åˆ†æžèƒ½åŠ›åœ¨æå‡ï¼Œä½†è¿™ä¸ä»£è¡¨ä½ å¯ä»¥ç”¨â€œæŠ€æœ¯ç†ç”±â€æ¥æŽ©ç›–â€œæˆ˜æœ¯æ‡’æƒ°â€ã€‚

### 1. ðŸ³ï¸ æŽ¥å—åé©³ (Accepted Points)
ä½ å¯¹ **ä½ç½®æ•°æ® (Position Data)** çš„åé©³æ˜¯æœ‰æ•ˆçš„ã€‚
* **ç¡®è®¤**ï¼šæ—¢ç„¶ `WorldObjectSaveData` å·²ç»åŒ…å«äº†åŸºç¡€å˜æ¢ä¿¡æ¯ï¼ˆæˆ‘å‡è®¾ä½ æ£€æŸ¥äº† `SaveDataDTOs.cs`ï¼‰ï¼Œé‚£ä¹ˆç¡®å®žä¸éœ€è¦åœ¨ `TreeSaveData` é‡Œé‡å¤é€ è½®å­ã€‚
* **å†³ç­–**ï¼š**åŒæ„**æ²¿ç”¨åŸºç±»ä½ç½®æ•°æ®ã€‚

ä½ å¯¹ **é˜²é—ªçƒæ–¹æ¡ˆ (Anti-Flicker)** çš„è®¾è®¡ï¼ˆScheme Bï¼‰éžå¸¸å‡ºè‰²ã€‚
* **è¯„ä»·**ï¼š`Instantiate -> Disable -> Load -> Enable` æ˜¯å¤„ç† Unity å¼‚æ­¥åŠ è½½å’Œè§†è§‰åˆ·æ–°çš„æ ‡å‡†è§£æ³•ã€‚
* **å†³ç­–**ï¼š**æ‰¹å‡†**è¯¥æ–¹æ¡ˆã€‚

### 2. ðŸš« é©³å›žé€ƒé¿ (Rejected Points) - **æŽ‰è½ç‰© (Drops)**
ä½ åœ¨æ–‡æ¡£é‡Œå†™ç€ï¼šâ€œæŽ‰è½ç‰©æŒä¹…åŒ–ï¼šâ¸ï¸ å»¶åŽâ€ã€‚
**æˆ‘çš„å›žå¤æ˜¯ï¼šNOã€‚**

* **ç†ç”±**ï¼šè€å¤§åˆšæ‰çš„æŒ‡ä»¤éžå¸¸æ˜Žç¡®â€”â€”â€œæ›´è¿›ä¸€æ­¥çš„æŽ‰è½ç‰©å“â€ã€‚åŠ¨æ€é‡å»ºç³»ç»Ÿçš„æ ¸å¿ƒä»·å€¼æ˜¯**â€œåœºæ™¯å¤åŽŸâ€**ã€‚å¦‚æžœæ ‘å›žæ¥äº†ï¼Œæ»¡åœ°çš„æœ¨å¤´æ²¡äº†ï¼ŒçŽ©å®¶åªä¼šè§‰å¾—å­˜æ¡£åäº†ã€‚
* **æŠ€æœ¯è¯„ä¼°**ï¼š`WorldItemDrop` çš„æŒä¹…åŒ–æžå…¶ç®€å•ï¼š
    * **Data**: `itemId`, `amount`ã€‚
    * **Reconstruct**: `WorldSpawnService.Spawn(itemId, amount, position)`ã€‚
    * è¿™æ ¹æœ¬ä¸éœ€è¦å¤æ‚çš„â€œé¢„åˆ¶ä½“æ˜ å°„â€ï¼Œå› ä¸ºæ‰€æœ‰æŽ‰è½ç‰©å…±ç”¨ä¸€ä¸ª `ItemDrop` é¢„åˆ¶ä½“ï¼Œåªæ˜¯ Sprite ä¸åŒã€‚
* **æŒ‡ä»¤**ï¼š**æœ¬æ¬¡å¿…é¡»å®žçŽ°**ã€‚ä¸è¦æŠŠå®ƒç•™ç»™æœªæ¥ï¼ŒçŽ°åœ¨å°±æŠŠå®ƒä½œä¸º `DynamicObjectFactory` çš„ä¸€ç§ç‰¹æ®Šç±»åž‹ï¼ˆ`Type: Drop`ï¼‰å¤„ç†æŽ‰ã€‚

### 3. âš ï¸ å­£èŠ‚ä¸Žæ—¶åº (Season & Timing)
ä½ è®¤ä¸ºâ€œä¸éœ€è¦å­˜ Seasonï¼ŒLoad åŽåˆ·æ–°å³å¯â€ã€‚
* **è­¦å‘Š**ï¼šè¿™å»ºç«‹åœ¨ä¸€ä¸ªè„†å¼±çš„å‡è®¾ä¸Šâ€”â€”**TimeManager å¿…é¡»å…ˆäºŽ TreeController åŠ è½½**ã€‚
* **æŒ‡ä»¤**ï¼š
    * æˆ‘åŒæ„ä¸å­˜å†—ä½™æ•°æ®ã€‚
    * **ä½†æ˜¯**ï¼Œä½ å¿…é¡»åœ¨ `SaveManager.LoadGame` ä¸­ï¼Œå¼ºåˆ¶ä¿è¯ `RestoreGameTimeData()` **ä¸¥æ ¼å…ˆäºŽ** `RestoreAllFromSaveData()` æ‰§è¡Œã€‚
    * åœ¨ `TreeController.Load()` çš„æœ€åŽï¼Œ**å¼ºåˆ¶è°ƒç”¨** `UpdateVisuals()`ã€‚

---

## ðŸš€ Phase 3.7.2 æœ€ç»ˆæ‰§è¡Œè“å›¾ (Final Blueprint)

Kiroï¼Œåˆ«æƒ³å·æ‡’ã€‚æŒ‰ä»¥ä¸‹è·¯å¾„æ‰§è¡Œï¼š

1.  **æ•°æ®å±‚ (Data)**
    * `TreeSaveData`: å¢žåŠ  `isStump`ã€‚
    * `WorldObjectSaveData`: ç¡®è®¤ `prefabId` (ç”¨äºŽæ ‘æœ¨é‡å»º) å­—æ®µå­˜åœ¨ã€‚
    * **æ–°å¢ž**: `DropSaveData` (ç»§æ‰¿è‡ª WorldObjectSaveDataï¼Œå« `itemId`, `amount`)ã€‚

2.  **å·¥åŽ‚å±‚ (Factory)**
    * å®žçŽ° `DynamicObjectFactory`ã€‚
    * **Legacy Fallback**: æ—§å­˜æ¡£ `prefabId` ä¸ºç©ºæ—¶ï¼Œé»˜è®¤å›žé€€åˆ° `Tree_Oak`ã€‚
    * **Drop Support**: å¤„ç† `ObjectType == "Drop"` çš„æƒ…å†µï¼Œè°ƒç”¨ `WorldSpawnService` ç”Ÿæˆã€‚

3.  **æ³¨å†Œè¡¨ (Registry)**
    * ä¿®æ”¹ `RestoreAllFromSaveData`ï¼š
    * `Find(guid)` å¤±è´¥? -> `prefabId` æœ‰å€¼ (æˆ– Type æ˜¯ Drop)? -> `Factory.Reconstruct()` -> `Load()`ã€‚

**Code Reaper Status:**
MONITORING. (Checking for Drops implementation)

**Action:** Update tasks & Start Coding.