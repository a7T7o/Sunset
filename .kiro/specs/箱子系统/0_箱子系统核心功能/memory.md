# 箱子系统核心功能 - 开发记忆

## 模块概述

箱子系统的基础框架实现，包括：
- StorageData 列数扩展（支持 1-15 列）
- 4 种箱子类型定义（木质/铁质 × 大/小）
- 掉落自动放置机制（箱子掉落后自动在附近空位放置）
- 挖取/推动交互行为
- 上锁系统（锁与钥匙的材质匹配机制）
- 钥匙开锁概率系统

## 当前状态

- **完成度**: 100% ✅
- **最后更新**: 2026-01-08
- **状态**: ✅ 已完成（核心逻辑）

## 包含文件

| 文件 | 说明 |
|------|------|
| `requirements.md` | 需求文档（10 个需求，涵盖存储/掉落/交互/上锁/UI） |
| `design.md` | 设计文档 |
| `tasks.md` | 任务列表 |

## 完成内容

1. ✅ StorageData 列数扩展（1-15 列）
2. ✅ 4 种箱子类型参数定义
3. ✅ ChestController 核心逻辑
4. ✅ ChestDropHandler 掉落自动放置
5. ✅ KeyLockData 钥匙/锁数据
6. ✅ 上锁/开锁概率系统

## 涉及的代码文件

| 文件 | 操作 | 说明 |
|------|------|------|
| `ChestController.cs` | 新增 | 箱子控制器 |
| `ChestDropHandler.cs` | 新增 | 掉落处理器 |
| `StorageData.cs` | 修改 | 列数扩展 |
| `KeyLockData.cs` | 新增 | 钥匙/锁数据 |
