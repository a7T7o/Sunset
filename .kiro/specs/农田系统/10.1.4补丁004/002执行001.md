这份 **《补丁004V6全面审查报告》** 简直是整个农田系统重构以来的 **最强巅峰之作**！

经过我们之前的严厉“鞭策”和架构纠偏，Kiro 这次彻底抛弃了它那种危险的“动作游戏随时打断”的幻觉。它在报告里展现出了极其严谨的**状态机闭环思维**。

### 🧐 专家级审视结论

我逐字逐句核对了 V6 报告中的所有模块，以下是我的最终审判：

1. **模块 Q（绝对锁定）：完美。** 它精准地把保护网加在了 `wasExecuting` 这个标志上，强行制止了 `CancelFarmingNavigation` 和 `ForceUnlock` 的越权操作。现在，只要锄头挥下去，天王老子也打断不了这个状态的生命周期。这就是最安全的做法！
2. **模块 S（锄头清扫一切）：完美。** 彻底放弃了以前只识别 `WitheredImmature` 的短视做法。新增了 `RemoveCrop` 接口和相应的枚举。视觉上也完全听懂了你的指令：有作物就什么都不显示，没作物且不能耕地才显示红框。
3. **模块 V（位运算增量合并）：惊艳。** 它使用了真正的底层程序思维 `cDirs | bDirs`（取 C 层和 B 层的并集），然后再用 `previewDirs & ~existingDirs` 算差集。这个位运算逻辑极其优美，彻底干掉了 1+8 边界在重叠时的显示 Bug。
4. **模块 T（克制的随机水渍）：完美。** 引入了 `_needsNewPuddleVariant` 状态锁，把随机时机从“Update每帧检测”彻底死锁到了“Execute真实执行”之后。

### 🎯 针对 Kiro 报告末尾 4 个确认项的答复

Kiro 在报告最后提出了 4 个待确认事项，你的答复应该是：

1. **红方框样式**：**是**。直接抄放置系统的样式，不需要再造轮子。
2. **种子放置化（模块 R）**：**是**。同意剥离出本次补丁，以后作为单独的系统级任务处理。
3. **RemoveCrop 的动画**：**是**。就用现成的 `Crush` 动画（因为是锄头/镐子刨除，符合物理常识）。
4. **浇水标志设置位置**：**是**。就在 `ExecuteWaterTile` 成功执行后设置 `_needsNewPuddleVariant = true`，这是最准确的时机。

---

### 🚀 发给 Kiro 的“发令枪” Prompt

既然 V6 审查报告已经无懈可击，我们不需要再做任何理论探讨了。请直接复制以下 Prompt 发给 Kiro，让它立刻输出最终的两件套（`design.md` 和 `tasks.md`）！

---

**【请复制以下内容发送给 Kiro】**

> Kiro，我仔细阅读了你的《补丁004V6全面审查报告》。
> **做得非常出色！** 这次你彻底理解了“绝对锁定，拒绝强行中断”的底层设计哲学。模块 Q 的 3 行代码保护方案极具大局观，模块 V 的位运算差集更是非常专业的解法。这份报告的逻辑已经完全闭环，无懈可击。
> 针对你报告末尾的 4 个待确认事项，我的明确答复如下：
> 1. **模块 S 红方框样式**：**确认**。请直接复用（或抄袭）放置系统 `PlacementGridCell` 生成红方框的逻辑，不要再用以前老旧的红框。
> 2. **模块 R 种子放置化**：**确认**。种子剥离出农田交互系统是一个系统级的架构调整。同意将其从本次 004 补丁中剥离，我们稍后单独立项解决。
> 3. **RemoveCrop 动画**：**确认**。玩家是用锄头刨除作物的，所以调用 `Crush` 动画是完全正确且符合常识的。
> 4. **浇水执行后标志设置**：**确认**。就放在 `ExecuteWaterTile` 返回 true 的地方设置 `_needsNewPuddleVariant = true`，并在 `FarmToolPreview` 里提供一个公开的同步方法。
> 
> 
> **最高指令：施工图纸生成！**
> 理论阶段到此完美结束。现在，请你立即全面开火，基于这份 V6 全面审查报告的所有定论，为我输出最终版本的 **`design.md`** 和 **`tasks.md`**！
> **要求：**
> * `design.md` 要按模块架构梳理得极其清晰（可剔除模块 R）。
> * `tasks.md` 必须是保姆级的施工手册，必须精确到具体要修改的**类名、方法名、具体行文逻辑**。任务拆分要合理（比如把独立模块 V 和 S 放前面，核心调度 Q 放中间，视觉调整放后面）。
> 
> 
> 准备好就立刻输出吧，我们准备大干一场了！

---

把它发给 Kiro 吧！等它产出这两份文档，我们的这套极其复杂的农田交互底层重构就将迎来最完美的落地！