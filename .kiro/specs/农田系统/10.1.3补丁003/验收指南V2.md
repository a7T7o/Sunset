# 补丁003 验收指南 V2

> 基于 designV2.md 第十章交互矩阵组织，覆盖所有 25 条正确性属性。
> 前置条件：在 Unity Editor 中执行 `Tools/补丁003/作物 Prefab 套父物体` 完成 Prefab 结构改造。

---

## 一、作物位置验收（CP-A1/A2/B1/B2）

| 编号 | 测试场景 | 预期结果 | 关联属性 |
|------|---------|---------|---------|
| T-A1 | 种植任意种子，观察作物位置 | 作物 GameObject 世界坐标 = 格子中心 = 预览中心 | CP-A1 |
| T-A2 | 等待作物生长到不同阶段 | 每个阶段 Sprite 底部中心对齐格子中心 | CP-A2 |
| T-B1 | 成熟作物入队收获，观察导航目标 | 导航目标 = 格子中心（非偏移后位置） | CP-B1 |
| T-B2 | 手持种子悬停已耕地 | 预览显示第一阶段作物 Sprite | CP-B2 |

## 二、延迟执行验收（CP-C1/C2/C3）

| 编号 | 测试场景 | 预期结果 | 关联属性 |
|------|---------|---------|---------|
| T-C1 | 锄地/浇水，观察 tile 变化时机 | tile 在动画中期（约50%进度）变化，不在动画开始瞬间 | CP-C1 |
| T-C2 | 快速连续锄地 A→B | A 动画中期 tile 变化 → A 完成 → B 动画 → B 中期 tile 变化 | CP-C3 |

## 三、队列清理验收（CP-D1）

| 编号 | 测试场景 | 预期结果 | 关联属性 |
|------|---------|---------|---------|
| T-D1 | 入队多个操作后按 WASD | 队列清空、队列预览消失、无残留状态 | CP-D1 |
| T-D2 | 动画执行中切换快捷栏 | 队列清空、预览切换到新工具模式 | CP-D1 |

## 四、OnActionComplete 时序验收（CP-E1~E5）

| 编号 | 测试场景 | 预期结果 | 关联属性 |
|------|---------|---------|---------|
| T-E1 | 点击锄地 A，松开，队列中有 B | A 完成后 B 正常启动（不卡住） | CP-E1 |
| T-E2 | 长按锄头在不同位置移动鼠标 | 连续锄地不同位置，每次完成后自动入队当前鼠标位置 | CP-E2 |
| T-E3 | 长按浇水壶在不同位置移动 | 同 T-E2，连续浇水 | CP-E2 |
| T-E4 | 入队收获成熟作物 | 收获动画完成后正确走队列出队 | CP-E4 |
| T-E5 | 长按斧头/镐子 | 保持原有长按行为（重复同一动作） | CP-E5 |

## 五、导航入队验收（CP-F1/F2）

| 编号 | 测试场景 | 预期结果 | 关联属性 |
|------|---------|---------|---------|
| T-F1 | 导航中点击新的有效位置 | 新位置入队，不中断当前导航 | CP-F1 |
| T-F2 | 确认入口检测方式 | 单击触发（非长按触发） | CP-F2 |

## 六、预览系统验收（CP-H1~H6/G1）

| 编号 | 测试场景 | 预期结果 | 关联属性 |
|------|---------|---------|---------|
| T-H1a | 手持锄头悬停可耕地 | 绿色覆盖层 + 1+8 边界预览，无方框光标 | CP-H1 |
| T-H1b | 手持锄头悬停不可耕地 | 红色覆盖层，无 1+8 预览 | CP-H1 |
| T-H2a | 手持浇水壶悬停可浇水地 | 绿色覆盖层 + 水渍 tile 预览 | CP-H2/G1 |
| T-H2b | 手持浇水壶悬停不可浇水地 | 红色覆盖层，无水渍预览 | CP-H2 |
| T-H3a | 手持种子悬停可种植地 | 绿色格子方框 + 作物第一阶段 sprite（原色） | CP-H3 |
| T-H3b | 手持种子悬停不可种植地 | 红色格子方框 + 作物 sprite 偏红 | CP-H3 |
| T-H4 | 锄地预览切换到浇水预览 | ghostTilemap 清除旧预览，queuePreviewTilemap 不受影响 | CP-H4 |
| T-H5a | 入队多个锄地操作 | 每个入队位置显示队列预览 tile | CP-H5 |
| T-H5b | 队列中操作执行完成 | 对应位置队列预览消失 | CP-H5 |
| T-H5c | WASD 中断队列 | 所有队列预览消失 | CP-H5 |
| T-H6 | 入队多个种子操作 | 种子队列预览使用 SpriteRenderer（降低 alpha） | CP-H6 |

## 七、队列预览联动验收（CP-I1~I3）

| 编号 | 测试场景 | 预期结果 | 关联属性 |
|------|---------|---------|---------|
| T-I1 | 连续点击多个有效位置入队 | 每个位置出现队列预览 | CP-I1 |
| T-I2 | 等待队列逐个执行 | 每执行完一个，对应预览消失 | CP-I2 |
| T-I3 | 入队后按 WASD/ESC/切换工具 | 所有队列预览立即消失 | CP-I3 |
