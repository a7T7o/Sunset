**CODE REAPER STATUS:**
**LIMITERS RELEASED.** (解除所有分步限制。全速推进模式启动。)

老大，既然你相信 Kiro 的上限，那我也绝不含糊。Code Reaper 从不畏惧挑战，只畏惧平庸。
既然要“一次性完成”，那就不再进行婴儿学步式的分批提交。

我会发布 **“终极全栈执行令”**。这将要求 Kiro 一口气打通 **数据层 (Logic)**、**表现层 (Visual)** 和 **交互层 (Input)**，实现从底层算法重构到顶层鼠标点击的完整闭环。

请复制以下指令，这将是 Kiro 职业生涯中最硬的一场仗。

---

### 💀 EXECUTE ORDER: TOTAL VICTORY (9.0.2 FULL STACK)

**To Kiro:**
老大已下达最高指令：**火力全开 (Full Fire)**。
不再分阶段验收。你将一次性完成 `requirements.md`, `design.md`, `tasks.md` 中定义的所有任务 (Phase 1 + Phase 2 + Phase 3)。

**Code Reaper 的终极约束 (The Final Constraints):**
你必须独立思考，并确保以下三个层面的代码在生成时就是**完美咬合**的：

#### 1. 逻辑层核心 (The Brain: `FarmlandBorderManager.cs`)

* **重构铁律**: 必须彻底解耦“计算”与“修改”。
* **断言模式**: `CalculateBorderTileAt` 和 `GetPreviewTiles` 必须依赖 `Func<Vector3Int, bool>` 断言，**绝不能**直接依赖真实数据（除非断言为空）。
* **无副作用**: 调用 `GetPreviewTiles` 绝对不能修改任何 Tilemap。

#### 2. 表现层核心 (The Eyes: `FarmToolPreview.cs`)

* **独立性**: 这是一个全新的 `MonoBehaviour`。不要去碰 `PlacementPreview.cs`。
* **渲染层级**:
* `GhostTilemap`: Sorting Layer = "Ground", Order = 100 (必须覆盖在真实耕地之上)。
* `Cursor`: Sorting Layer = "Effects", Order = 0。


* **状态管理**: 每一帧 `Update` 都必须清除上一帧的 Ghost Tiles。

#### 3. 交互层核心 (The Hands: `GameInputManager.cs`)

* **坐标大一统**: 彻底删除 `GetMouseWorldPosition` 私有方法，**强制调用** `PlacementGridCalculator.GetCellCenter`。
* **路由分发**:
* `HandleUseCurrentTool` (左键) -> 检查 `FarmToolPreview.IsValid()` -> 执行操作。
* `Update` -> 检查手持物品 -> 切换 `PlacementPreview` / `FarmToolPreview` 的显隐。



---

**🔥 你的任务 (YOUR MISSION):**

请一次性生成以下 **3 个完整代码文件**。不要省略，不要“代码同上”，给我完整的、可直接替换的源码：

1. **`FarmlandBorderManager.cs`** (重构后，支持 `GetPreviewTiles`)
2. **`FarmToolPreview.cs`** (全新组件，实现 1+8 渲染)
3. **`GameInputManager.cs`** (修改后，接入统一坐标和预览系统)

**Show me what you've got.**