# å†œç”°ç³»ç»Ÿå…¨é¢å®¡æŸ¥æŠ¥å‘Š

> å®¡æŸ¥æ—¶é—´ï¼š2026-02-15
> å®¡æŸ¥ç›®çš„ï¼šåœ¨è¿›å…¥ 10.1.0 å…¨é¢æŒä¹…åŒ–ä¹‹å‰ï¼Œå¯¹æ‰€æœ‰å†œç”°ç³»ç»Ÿå·¥ä½œåŒºè¿›è¡ŒåŸºäºä»£ç äº‹å®çš„å…¨é¢å®¡æŸ¥
> å®¡æŸ¥æ–¹æ³•ï¼šéå†æ¯ä¸ªå·¥ä½œåŒºçš„ memory/éœ€æ±‚/é”è¯„/éªŒæ”¶æŒ‡å—ï¼Œå¯¹ç…§å®é™…ä»£ç ï¼Œé€é¡¹ç¡®è®¤çœŸå®å®ŒæˆçŠ¶æ€

---

## ç¬¬ä¸€éƒ¨åˆ†ï¼šå·¥ä½œåŒºè¿›ç¨‹æ€»è§ˆ

| å·¥ä½œåŒº | å®Œæˆåº¦ | æ ¸å¿ƒå†…å®¹ | éªŒæ”¶çŠ¶æ€ |
|--------|--------|---------|---------|
| 8_ä¿®å¤ | 0% | 5 ä¸ª P1 é—®é¢˜ | âŒ æœªæ‰§è¡Œ |
| 9.0.1 é‡ç”Ÿä¹‹æˆ‘åœ¨ç§ç”° | 80% | åŸºç¡€è€•åœ°ç³»ç»Ÿ | âš ï¸ ä»£ç å®Œæˆï¼Œå¾…éªŒæ”¶ |
| 9.0.2 æ”¾ç½®å†œç”° | 80% | FarmToolPreview è”é‚¦åˆ¶ | âš ï¸ ä»£ç å®Œæˆï¼ŒPhase 4 å¾…éªŒæ”¶ |
| 9.0.3 é¢„è§ˆå†œç”° | 90% | åŠ¨æ€ Layer/éšœç¢ç‰©/è·ç¦»/ç§å­é¢„è§ˆ | âš ï¸ ä»£ç å®Œæˆï¼ŒNavGrid åˆ·æ–°å¾…åç»­ |
| 9.0.4 æ™ºèƒ½äº¤äº’å‡çº§ | 30% | è‡ªåŠ¨å¯¼èˆª+åˆ°è¾¾æ‰§è¡Œ | âš ï¸ è®¾è®¡å®Œæˆï¼Œå¾…å®ç° |
| 9.0.5 æ™ºèƒ½äº¤äº’ bug ä¿®å¤ | 100% | é”å®šæœºåˆ¶/é¢„è§ˆä¿®å¤ | âš ï¸ ä»£ç å®Œæˆï¼Œå¾…ç”¨æˆ·æ¸¸æˆå†…éªŒæ”¶ |
| 10.0.1 å†œä½œç‰©è®¾è®¡ä¸å®Œå–„ | 100% | CropController çŠ¶æ€æœº/å­˜æ¡£/PBT | âš ï¸ ä»£ç å®Œæˆï¼Œå¾…éªŒæ”¶ |
| 10.0.2 å†œBUGå†œSO | 100% | CropStageConfig Prefab é©±åŠ¨ | âš ï¸ ä»£ç å®Œæˆï¼Œå¾…éªŒæ”¶ |
| 10.0.2.1 çº æ­£ | 100% | åºŸå¼ƒ CropManager/æ‰è½æ¨¡å¼/æ’­ç§é‡å†™ | âš ï¸ ä»£ç å®Œæˆï¼Œå¾…éªŒæ”¶ |
| 10.0.3 æ”¶è·DropTableä¸åŠ¨ç”» | 80% | US-1/2/4/5 å·²å®Œæˆï¼ŒUS-3 å¾…å®ç° | âš ï¸ Collect åŠ¨ç”»æœªé›†æˆ |

---

## ç¬¬äºŒéƒ¨åˆ†ï¼šæŒ‰åŠŸèƒ½æ¨¡å—é€é¡¹å®¡æŸ¥

### æ¨¡å— Aï¼šè€•åœ°ç³»ç»Ÿï¼ˆFarmTileManager + FarmTileDataï¼‰

#### A1. è€•åœ°åˆ›å»ºä¸ç®¡ç†
- éœ€æ±‚æ¥æºï¼š9.0.1
- ä»£ç çŠ¶æ€ï¼šâœ… å·²å®ç°
- æ ¸å¿ƒæ–¹æ³•ï¼š`CreateTile()`ã€`CanTillAt()`ã€`RemoveTile()`
- å¤šæ¥¼å±‚æ”¯æŒï¼šâœ… `farmTilesByLayer` å­—å…¸æŒ‰æ¥¼å±‚ç´¢å¼•å­˜å‚¨

#### A2. æµ‡æ°´ç³»ç»Ÿ
- éœ€æ±‚æ¥æºï¼š9.0.1
- ä»£ç çŠ¶æ€ï¼šâœ… å·²å®ç°
- æ ¸å¿ƒæ–¹æ³•ï¼š`SetWatered()` â†’ è®¾ç½® `wateredToday`/`waterTime`/`puddleVariant`/`moistureState`
- æ—¥ç»“é‡ç½®ï¼šâœ… `ResetDailyWaterState()` â†’ `wateredYesterday = wateredToday; wateredToday = false`
- è§†è§‰æ›´æ–°ï¼šâœ… `FarmVisualManager.UpdateTileVisual()` æ ¹æ® `moistureState` è®¾ç½®æ°´æ¸ Tile

#### A3. è€•åœ°å­˜æ¡£
- éœ€æ±‚æ¥æºï¼š10.0.1
- ä»£ç çŠ¶æ€ï¼šâš ï¸ éƒ¨åˆ†å®ç°
- `FarmTileSaveData` å­˜å‚¨å­—æ®µï¼š`tileX`/`tileY`/`layer`/`soilState`/`isWatered`
- ğŸ”´ **é—æ¼ 1**ï¼š`wateredYesterday` æœªå­˜æ¡£ â†’ åŠ è½½åä¸¢å¤±"æ˜¨å¤©æ˜¯å¦æµ‡æ°´"ä¿¡æ¯ï¼Œå¯¼è‡´åŠ è½½å½“å¤©ä½œç‰©ä¸ä¼šç”Ÿé•¿ï¼ˆå³ä½¿å­˜æ¡£å‰å·²æµ‡æ°´ï¼‰
- ğŸ”´ **é—æ¼ 2**ï¼š`waterTime` æœªå­˜æ¡£ â†’ åŠ è½½åæ°´æ¸è§†è§‰çŠ¶æ€æ— æ³•æ¢å¤ï¼ˆé»˜è®¤ -1f = å¹²ç‡¥ï¼‰
- ğŸ”´ **é—æ¼ 3**ï¼š`puddleVariant` æœªå­˜æ¡£ â†’ åŠ è½½åæ°´æ¸å˜ä½“ä¸¢å¤±
- å½±å“è¯„ä¼°ï¼š**ä¸­ç­‰ä¸¥é‡** â€” å­˜æ¡£/è¯»æ¡£åè€•åœ°æµ‡æ°´çŠ¶æ€ä¸å®Œæ•´ï¼Œä½†ä¸å½±å“è€•åœ°æœ¬èº«çš„å­˜åœ¨

#### A4. è€•åœ°è¾¹ç•Œç³»ç»Ÿï¼ˆFarmlandBorderManagerï¼‰
- éœ€æ±‚æ¥æºï¼š9.0.1/9.0.2
- ä»£ç çŠ¶æ€ï¼šâœ… å·²å®ç°
- æ–­è¨€æ¨¡å¼é¢„è§ˆï¼šâœ… `GetPreviewTiles()` + `CalculateBorderTileAt()`

#### A5. æ°´æ¸è§†è§‰ç³»ç»Ÿï¼ˆFarmVisualManagerï¼‰
- éœ€æ±‚æ¥æºï¼š9.0.1/9.0.5
- ä»£ç çŠ¶æ€ï¼šâœ… å·²å®ç°
- `waterPuddleTilemapNew` å­—æ®µï¼šâœ… åœ¨ `LayerTilemaps` ä¸­å®šä¹‰
- ğŸŸ¡ **é…ç½®ä¾èµ–**ï¼šéœ€è¦åœ¨ Inspector ä¸­ä¸ºæ¯ä¸ªæ¥¼å±‚é…ç½® `waterPuddleTilemapNew`ï¼Œå¦åˆ™æ°´æ¸ä¸æ˜¾ç¤º
- æ—§å­—æ®µæ¸…ç†ï¼šâœ… `farmlandTilemap`/`waterPuddleTilemap` å·²æ ‡è®° `[Obsolete]` + `[HideInInspector]`

---

### æ¨¡å— Bï¼šä½œç‰©ç³»ç»Ÿï¼ˆCropControllerï¼‰

#### B1. ä½œç‰©çŠ¶æ€æœº
- éœ€æ±‚æ¥æºï¼š10.0.1
- ä»£ç çŠ¶æ€ï¼šâœ… å·²å®ç°
- 4 çŠ¶æ€ï¼š`Growing` â†’ `Mature` â†’ `WitheredImmature`/`WitheredMature`
- çŠ¶æ€è½¬æ¢éªŒè¯ï¼šâœ… `IsValidTransition()` é™æ€æ–¹æ³•
- å›ºå®š 4 é˜¶æ®µå¸¸é‡ï¼šâœ… `CROP_STAGE_SEED=0`/`SPROUT=1`/`GROWING=2`/`MATURE=3`

#### B2. ç”Ÿé•¿æœºåˆ¶
- éœ€æ±‚æ¥æºï¼š10.0.1/10.0.2
- ä»£ç çŠ¶æ€ï¼šâœ… å·²å®ç°
- `daysToNextStage` ç´¯åŠ æ¨¡å¼ï¼šâœ… `UpdateGrowthStage()` æŒ‰é˜¶æ®µç´¯åŠ å¤©æ•°åˆ¤æ–­
- `needsWatering` å­—æ®µï¼šâœ… å·²ä» SeedData è¿ç§»åˆ° CropControllerï¼ˆ10.0.2.1 ä¼šè¯ 4ï¼‰
- æµ‡æ°´ä¾èµ–ï¼šâœ… `HandleGrowingDay()` æ£€æŸ¥ `tileData.wateredYesterday`
- æ¯èæœºåˆ¶ï¼šâœ… è¿ç»­ `daysUntilWithered` å¤©æœªæµ‡æ°´ â†’ `WitheredImmature`
- è¿‡ç†Ÿæ¯èï¼šâœ… `HandleMatureDay()` æ£€æŸ¥ `daysSinceMature >= daysUntilOverMature`

#### B3. æ”¶è·æœºåˆ¶
- éœ€æ±‚æ¥æºï¼š10.0.2.1 çº æ­£
- ä»£ç çŠ¶æ€ï¼šâœ… å·²å®ç°ï¼ˆæ‰è½æ¨¡å¼ï¼‰
- `HarvestMature()`ï¼šâœ… ä½¿ç”¨ `dropItemData` + `WorldSpawnService.SpawnMultiple()` æ‰è½
- `HarvestWitheredMature()`ï¼šâœ… ä½¿ç”¨ `witheredDropItemData` æ‰è½
- å¯é‡å¤æ”¶è·ï¼šâœ… `ResetForReHarvest()` ç´¯åŠ æ¨¡å¼é‡ç½®
- æ—§æ–¹æ³•åºŸå¼ƒï¼šâœ… `DetermineHarvestQuality()`/`DropItemToWorld()` æ ‡è®° `[Obsolete]`
- ğŸŸ¡ **Collect åŠ¨ç”»æœªé›†æˆ**ï¼šå½“å‰æ”¶è·æ˜¯å³æ—¶æ‰§è¡Œï¼Œæ²¡æœ‰æ’­æ”¾å¼¯è…°æ‹”èµ·åŠ¨ç”»ï¼ˆ10.0.3 US-3 å¾…å®ç°ï¼‰

#### B4. ä½œç‰©å­˜æ¡£
- éœ€æ±‚æ¥æºï¼š10.0.1
- ä»£ç çŠ¶æ€ï¼šâœ… å·²å®ç°
- `CropSaveData` å­—æ®µï¼š`seedId`/`currentStage`/`grownDays`/`daysWithoutWater`/`isWithered`/`quality`/`harvestCount`/`lastHarvestDay`/`daysSinceMature`/`layerIndex`/`cellX`/`cellY`
- `Save()`ï¼šâœ… å®Œæ•´åºåˆ—åŒ–æ‰€æœ‰è¿è¡Œæ—¶æ•°æ®
- `Load()`ï¼šâœ… ååºåˆ—åŒ– + æ¢å¤ `FarmTileData.cropController` å¼•ç”¨ + `RestoreStateFromData()`
- ğŸŸ¡ **needsWatering ä¸åœ¨å­˜æ¡£ä¸­**ï¼š`needsWatering` æ˜¯ `[SerializeField]` åœ¨ Prefab ä¸Šé…ç½®ï¼ŒåŠ è½½æ—¶é€šè¿‡ Prefab å®ä¾‹åŒ–è‡ªåŠ¨æ¢å¤ï¼Œä¸éœ€è¦å­˜æ¡£ â†’ **æ— é—®é¢˜**

#### B5. ä½œç‰©é‡å»ºï¼ˆDynamicObjectFactoryï¼‰
- éœ€æ±‚æ¥æºï¼š10.0.2
- ä»£ç çŠ¶æ€ï¼šâœ… å·²å®ç°
- `TryReconstructCrop()`ï¼šâœ… è§£æ CropSaveData â†’ seedId è·å– SeedData â†’ cropPrefab å®ä¾‹åŒ– â†’ è®¾ç½® GUID â†’ æ³¨å†Œ Registry
- `TryReconstruct()` ä¸­ "Crop" åˆ†æ”¯ï¼šâœ… å·²æ·»åŠ 
- `SetPersistentId()` ä¸­ CropController åˆ†æ”¯ï¼šâœ… å·²æ·»åŠ 

---

### æ¨¡å— Cï¼šé¢„è§ˆç³»ç»Ÿï¼ˆFarmToolPreviewï¼‰

#### C1. é”„å¤´é¢„è§ˆï¼ˆ1+8 æ¨¡å¼ï¼‰
- éœ€æ±‚æ¥æºï¼š9.0.2
- ä»£ç çŠ¶æ€ï¼šâœ… å·²å®ç°
- `UpdateHoePreview()`ï¼šâœ… è°ƒç”¨ `FarmlandBorderManager.GetPreviewTiles()` æ˜¾ç¤º 1+8 é¢„è§ˆ
- Lazy Singletonï¼šâœ… è‡ªåŠ¨åˆ›å»ºå®ä¾‹ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®åœºæ™¯
- ç¨‹åºåŒ–å…‰æ ‡ Spriteï¼šâœ… `CreateProceduralCursorSprite()` 16x16 ç™½è‰²æ–¹æ¡†

#### C2. æµ‡æ°´é¢„è§ˆ
- éœ€æ±‚æ¥æºï¼š9.0.2
- ä»£ç çŠ¶æ€ï¼šâœ… å·²å®ç°
- `UpdateWateringPreview()`ï¼šâœ… å…‰æ ‡é¢„è§ˆï¼ˆæ—  1+8ï¼‰
- é¢œè‰²åé¦ˆï¼šâœ… ç»¿è‰²=æœ‰æ•ˆï¼Œçº¢è‰²=æ— æ•ˆï¼Œè“è‰²=æµ‡æ°´

#### C3. ç§å­é¢„è§ˆ
- éœ€æ±‚æ¥æºï¼š9.0.3
- ä»£ç çŠ¶æ€ï¼šâœ… å·²å®ç°
- `UpdateSeedPreview()`ï¼šâœ… å…‰æ ‡é¢„è§ˆï¼ˆç®€åŒ–ç‰ˆï¼Œä¸æ˜¾ç¤ºä½œç‰©å®Œå…¨ä½“ï¼‰

#### C4. åŠ¨æ€ Sorting Layer è·Ÿéš
- éœ€æ±‚æ¥æºï¼š9.0.3
- ä»£ç çŠ¶æ€ï¼šâœ… å·²å®ç°
- `UpdateSortingLayer()`ï¼šâœ… è·Ÿéšç©å®¶æ¥¼å±‚

#### C5. éšœç¢ç‰©æ£€æµ‹
- éœ€æ±‚æ¥æºï¼š9.0.3
- ä»£ç çŠ¶æ€ï¼šâœ… å·²å®ç°
- `PlacementValidator.HasFarmingObstacle()`ï¼šâœ… æ’é™¤ Playerï¼Œæ£€æµ‹ Tree/Rock/Building

#### C6. è·ç¦»æ£€æµ‹
- éœ€æ±‚æ¥æºï¼š9.0.3
- ä»£ç çŠ¶æ€ï¼šâœ… å·²å®ç°
- `IsWithinReach()`ï¼šâœ… åŸºäº playerTransform å’Œ reach å‚æ•°

#### C7. é”å®šæœºåˆ¶
- éœ€æ±‚æ¥æºï¼š9.0.5
- ä»£ç çŠ¶æ€ï¼šâœ… å·²å®ç°
- `WateringFailureReason` æšä¸¾ï¼šâœ… åŒºåˆ†å¤±è´¥åŸå› 

---

### æ¨¡å— Dï¼šæ’­ç§ç³»ç»Ÿ

#### D1. æ’­ç§é“¾è·¯
- éœ€æ±‚æ¥æºï¼š9.0.1/10.0.2.1 çº æ­£
- ä»£ç çŠ¶æ€ï¼šâœ… å·²å®ç°ï¼ˆ10.0.2.1 é‡å†™ï¼‰
- é“¾è·¯ï¼š`HandleUseCurrentTool` â†’ `TryPlantSeed` â†’ `ExecutePlantSeed`
- ç»•è¿‡ CropManagerï¼šâœ… ç›´æ¥ `Instantiate(seedData.cropPrefab)`
- ç§å­è¢‹è‡ªåŠ¨åˆå§‹åŒ–ï¼šâœ… `ExecutePlantSeed` ä¸­æ£€æµ‹æœªåˆå§‹åŒ–ç§å­è¢‹å¹¶è‡ªåŠ¨åˆå§‹åŒ–

#### D2. ç§å­è¢‹ä¿è´¨æœŸ
- éœ€æ±‚æ¥æºï¼š10.0.1
- ä»£ç çŠ¶æ€ï¼šâœ… å·²å®ç°
- `SeedBagHelper`ï¼šâœ… `IsSeedBag()`/`IsExpired()`/`ConsumeSeed()`
- æ—¥ç»“æ£€æŸ¥ï¼šâœ… `InventoryService.OnDayChanged()` æ£€æŸ¥è¿‡æœŸç§å­è¢‹ â†’ æ›¿æ¢ä¸ºè…çƒ‚é£Ÿç‰©
- è…çƒ‚é£Ÿç‰©åˆå¹¶ï¼šâœ… `TryMergeRottenFood()`

---

### æ¨¡å— Eï¼šäº¤äº’ç³»ç»Ÿ

#### E1. æ™ºèƒ½äº¤äº’ï¼ˆè‡ªåŠ¨å¯¼èˆª+åˆ°è¾¾æ‰§è¡Œï¼‰
- éœ€æ±‚æ¥æºï¼š9.0.4
- ä»£ç çŠ¶æ€ï¼šâš ï¸ **è®¾è®¡å®Œæˆï¼Œæœªå®ç°**
- 9.0.4 memory æ ‡è®°å®Œæˆåº¦ 30%ï¼ˆè®¾è®¡å®Œæˆï¼Œå¾…æ‰§è¡Œï¼‰
- ğŸŸ¡ **æ ¸å¿ƒåŠŸèƒ½ç¼ºå¤±**ï¼šè·ç¦»ä¸å¤Ÿæ—¶åº”è§¦å‘è‡ªåŠ¨å¯¼èˆª â†’ åˆ°è¾¾åè‡ªåŠ¨æ‰§è¡Œï¼Œå½“å‰ä»æ˜¯"çº¢è‰²å…‰æ ‡ + ç‚¹å‡»æ— æ•ˆ"
- å½±å“è¯„ä¼°ï¼š**åŠŸèƒ½æ€§ç¼ºå¤±** â€” ç©å®¶ä½“éªŒä¸ä½³ï¼Œä½†ä¸å½±å“æ ¸å¿ƒç§æ¤/æ”¶è·æµç¨‹

#### E2. Collect åŠ¨ç”»é›†æˆ
- éœ€æ±‚æ¥æºï¼š10.0.3 US-3
- ä»£ç çŠ¶æ€ï¼šâŒ **æœªå®ç°**
- å½“å‰æ”¶è·æ˜¯å³æ—¶æ‰§è¡Œï¼ˆå³é”® â†’ ç›´æ¥æ”¶è·ï¼‰ï¼Œæ²¡æœ‰æ’­æ”¾ Collect åŠ¨ç”»
- å½±å“è¯„ä¼°ï¼š**ä½“éªŒç¼ºå¤±** â€” åŠŸèƒ½å¯ç”¨ä½†ç¼ºå°‘åŠ¨ç”»åé¦ˆ

---

### æ¨¡å— Fï¼šSO æ•°æ®ç»“æ„

#### F1. SeedData å­—æ®µçŠ¶æ€
- ä»£ç çŠ¶æ€ï¼šâœ… å·²ç²¾ç®€
- æ´»è·ƒå­—æ®µï¼š`cropPrefab`/`isReHarvestable`/`reHarvestDays`/`maxHarvestCount`/`plantingExp`/`harvestingExp`/`needsWatering`(Obsolete)
- å·²åˆ é™¤å­—æ®µï¼š`growthDays`/`harvestCropID`/`harvestAmountRange`ï¼ˆ10.0.3 ä¼šè¯ 4 ç›´æ¥åˆ é™¤ï¼‰
- `needsWatering`ï¼šâœ… å·²æ ‡è®° `[Obsolete]`ï¼Œè¿ç§»åˆ° CropController

#### F2. CropData å­—æ®µçŠ¶æ€
- ä»£ç çŠ¶æ€ï¼šâœ… å·²ç²¾ç®€
- `seedID`/`witheredCropID`ï¼šâœ… æ ‡è®° `[Obsolete]`
- `harvestExp`ï¼šâœ… æ ‡è®° `[Obsolete]`ï¼ˆç»éªŒå€¼ç»Ÿä¸€å½’ SeedDataï¼‰

#### F3. WitheredCropData å­—æ®µçŠ¶æ€
- ä»£ç çŠ¶æ€ï¼šâœ… å·²ç²¾ç®€
- `seedID`ï¼šâœ… æ ‡è®° `[Obsolete]`
- `normalCropID`ï¼šâœ… å·²ç›´æ¥åˆ é™¤

#### F4. CropStageConfig
- ä»£ç çŠ¶æ€ï¼šâœ… å·²å®ç°
- å­—æ®µï¼š`sprite`/`daysToNextStage`
- åœ¨ CropController Prefab ä¸Šé…ç½®ï¼ˆInspectorï¼‰

#### F5. ToolData.effectRadius
- éœ€æ±‚æ¥æºï¼š8_ä¿®å¤ P1
- ä»£ç çŠ¶æ€ï¼šğŸ”´ **æœªä¿®å¤**
- å½“å‰ï¼š`int` ç±»å‹ + `[Range(1, 5)]`
- ç”¨æˆ·éœ€æ±‚ï¼š`float` ç±»å‹ï¼Œæ”¯æŒ 0.4 ç­‰å°æ•°å€¼
- å½±å“è¯„ä¼°ï¼š**ä½** â€” å½“å‰ç³»ç»Ÿæœªä½¿ç”¨æ­¤å­—æ®µè¿›è¡Œå®é™…åŠå¾„è®¡ç®—

---

## ç¬¬ä¸‰éƒ¨åˆ†ï¼šå­˜æ¡£ç³»ç»Ÿå®Œæ•´æ€§å®¡æŸ¥

### å­˜æ¡£å­—æ®µè¦†ç›–ç‡

#### FarmTileSaveDataï¼ˆè€•åœ°å­˜æ¡£ï¼‰

| è¿è¡Œæ—¶å­—æ®µ | æ˜¯å¦å­˜æ¡£ | å­˜æ¡£å­—æ®µå | å¤‡æ³¨ |
|-----------|---------|-----------|------|
| position.x/y | âœ… | tileX/tileY | |
| layerIndex | âœ… | layer | |
| isTilled | âœ… | éšå«ï¼ˆåªå­˜å·²è€•ä½œçš„ï¼‰ | |
| moistureState | âœ… | soilState | |
| wateredToday | âœ… | isWatered | |
| wateredYesterday | ğŸ”´ **ç¼ºå¤±** | â€” | åŠ è½½åä¸¢å¤±ï¼Œå½±å“ä½œç‰©ç”Ÿé•¿åˆ¤æ–­ |
| waterTime | ğŸ”´ **ç¼ºå¤±** | â€” | åŠ è½½åé»˜è®¤ -1fï¼Œæ°´æ¸è§†è§‰æ— æ³•æ¢å¤ |
| puddleVariant | ğŸ”´ **ç¼ºå¤±** | â€” | åŠ è½½åé»˜è®¤ 0ï¼Œæ°´æ¸å˜ä½“ä¸¢å¤± |
| cropData | âœ… | ç”± CropController ç‹¬ç«‹å­˜æ¡£ | |
| cropController | N/A | è¿è¡Œæ—¶å¼•ç”¨ï¼Œä¸éœ€è¦å­˜æ¡£ | |

#### CropSaveDataï¼ˆä½œç‰©å­˜æ¡£ï¼‰

| è¿è¡Œæ—¶å­—æ®µ | æ˜¯å¦å­˜æ¡£ | å­˜æ¡£å­—æ®µå | å¤‡æ³¨ |
|-----------|---------|-----------|------|
| seedData.itemID | âœ… | seedId | |
| instanceData.currentStage | âœ… | currentStage | |
| instanceData.grownDays | âœ… | grownDays | |
| instanceData.daysWithoutWater | âœ… | daysWithoutWater | |
| instanceData.isWithered | âœ… | isWithered | |
| instanceData.quality | âœ… | quality | |
| instanceData.harvestCount | âœ… | harvestCount | |
| instanceData.lastHarvestDay | âœ… | lastHarvestDay | |
| daysSinceMature | âœ… | daysSinceMature | |
| layerIndex | âœ… | layerIndex | |
| cellPosition.x/y | âœ… | cellX/cellY | |
| state (CropState) | âœ… | é€šè¿‡ RestoreStateFromData() æ¢å¤ | |
| needsWatering | N/A | Prefab SerializeFieldï¼Œå®ä¾‹åŒ–è‡ªåŠ¨æ¢å¤ | |
| stages[] | N/A | Prefab SerializeFieldï¼Œå®ä¾‹åŒ–è‡ªåŠ¨æ¢å¤ | |
| dropItemData ç­‰ | N/A | Prefab SerializeFieldï¼Œå®ä¾‹åŒ–è‡ªåŠ¨æ¢å¤ | |

ç»“è®ºï¼šCropSaveData **å®Œæ•´**ï¼Œæ‰€æœ‰è¿è¡Œæ—¶æ•°æ®å‡å·²è¦†ç›–ã€‚

### å­˜æ¡£é‡å»ºé“¾è·¯

```
åŠ è½½å­˜æ¡£ â†’ WorldObjectSaveData (objectType="Crop")
  â†’ DynamicObjectFactory.TryReconstruct()
    â†’ TryReconstructCrop()
      â†’ è§£æ CropSaveData
      â†’ seedId â†’ ItemDatabase.GetItemByID() â†’ SeedData
      â†’ SeedData.cropPrefab â†’ Instantiate
      â†’ SetPersistentId(guid)
      â†’ Register to PersistentObjectRegistry
  â†’ CropController.Load()
    â†’ æ¢å¤ä½ç½®/SortingLayer
    â†’ æ¢å¤ instanceData æ‰€æœ‰å­—æ®µ
    â†’ æ¢å¤ FarmTileData.cropController å¼•ç”¨
    â†’ RestoreStateFromData() æ¢å¤çŠ¶æ€æœº
    â†’ UpdateVisuals() æ¢å¤è§†è§‰
```

ğŸŸ¢ é‡å»ºé“¾è·¯å®Œæ•´ï¼Œæ— æ–­è£‚ç‚¹ã€‚

---

## ç¬¬å››éƒ¨åˆ†ï¼šå…³é”®é—®é¢˜æ¸…å•ï¼ˆæŒ‰ä¼˜å…ˆçº§æ’åºï¼‰

### ğŸ”´ P0 â€” å­˜æ¡£æ•°æ®ç¼ºå¤±ï¼ˆå¿…é¡»åœ¨ 10.1.0 ä¿®å¤ï¼‰

| # | é—®é¢˜ | å½±å“ | ä¿®å¤æ–¹æ¡ˆ |
|---|------|------|---------|
| P0-1 | FarmTileSaveData ç¼ºå°‘ `wateredYesterday` | åŠ è½½åå½“å¤©ä½œç‰©ä¸ç”Ÿé•¿ï¼ˆå³ä½¿å­˜æ¡£å‰å·²æµ‡æ°´ï¼‰ | FarmTileSaveData æ–°å¢å­—æ®µ + Save/Load é€‚é… |
| P0-2 | FarmTileSaveData ç¼ºå°‘ `waterTime` | åŠ è½½åæ°´æ¸è§†è§‰æ— æ³•æ¢å¤ | FarmTileSaveData æ–°å¢å­—æ®µ + Save/Load é€‚é… |
| P0-3 | FarmTileSaveData ç¼ºå°‘ `puddleVariant` | åŠ è½½åæ°´æ¸å˜ä½“ä¸¢å¤± | FarmTileSaveData æ–°å¢å­—æ®µ + Save/Load é€‚é… |

### ğŸŸ¡ P1 â€” åŠŸèƒ½ç¼ºå¤±ï¼ˆå»ºè®®åœ¨ 10.1.0 æˆ–åç»­è¿­ä»£ä¿®å¤ï¼‰

| # | é—®é¢˜ | å½±å“ | æ¥æº |
|---|------|------|------|
| P1-1 | 9.0.4 æ™ºèƒ½äº¤äº’æœªå®ç° | è·ç¦»ä¸å¤Ÿæ—¶æ— æ³•è‡ªåŠ¨å¯¼èˆª | 9.0.4 è®¾è®¡å®Œæˆä½†æœªæ‰§è¡Œ |
| P1-2 | Collect åŠ¨ç”»æœªé›†æˆ | æ”¶è·æ— åŠ¨ç”»åé¦ˆ | 10.0.3 US-3 |
| P1-3 | plantingExp/harvestingExp æœªæ¥å…¥ Controller | ç§æ¤/æ”¶è·ä¸ç»™ç»éªŒ | ä»£åŠ #5 |
| P1-4 | Tooltip ç”Ÿé•¿å‘¨æœŸæ— æ•°æ®æº | growthDays å·²åˆ é™¤ï¼Œæ— æ³•æ˜¾ç¤º | ä»£åŠ #5â‘£ |
| P1-5 | ToolData.effectRadius ä»æ˜¯ int | ä¸æ”¯æŒ 0.4 ç­‰å°æ•°å€¼ | 8_ä¿®å¤ P1 |

### ğŸŸ¢ P2 â€” å¾…éªŒæ”¶/å¾…é…ç½®ï¼ˆä¸å½±å“ä»£ç æ­£ç¡®æ€§ï¼‰

| # | é—®é¢˜ | è¯´æ˜ |
|---|------|------|
| P2-1 | 9.0.2 Phase 4 é›†æˆæµ‹è¯• | ä»£ç å®Œæˆï¼Œéœ€ç”¨æˆ·æ¸¸æˆå†…éªŒæ”¶ |
| P2-2 | 9.0.5 é¢„è§ˆé”å®šéªŒæ”¶ | ä»£ç å®Œæˆï¼Œéœ€ç”¨æˆ·æ¸¸æˆå†…éªŒæ”¶ |
| P2-3 | 10.0.1 ç§æ¤â†’ç”Ÿé•¿â†’æ”¶è·å®Œæ•´æµç¨‹éªŒæ”¶ | ä»£ç å®Œæˆï¼Œéœ€ç”¨æˆ·æ¸¸æˆå†…éªŒæ”¶ |
| P2-4 | CropController Prefab Inspector é…ç½® | éœ€é…ç½® dropItemData/witheredDropItemData/stages |
| P2-5 | waterPuddleTilemapNew Inspector é…ç½® | æ¯ä¸ªæ¥¼å±‚éœ€é…ç½®æ°´æ¸ Tilemap |
| P2-6 | reHarvestDays/maxHarvestCount æš‚ä¿ç•™é—²ç½® | é»˜è®¤æ‰€æœ‰ä½œç‰©ä¸€æ¬¡æ€§ï¼Œåç»­å¯ç”¨ |
| P2-7 | NavGrid åˆ·æ–°é›†æˆ | 9.0.3 P3 å¾…åç»­å®ç° |
| P2-8 | è‚¥æ–™ç³»ç»Ÿ | çº¯æ–°åŠŸèƒ½ï¼Œæœªå¼€å§‹ |
| P2-9 | å“è´¨å½±å“ç³»ç»Ÿ | éœ€ä¸ SO å“è´¨ç³»ç»Ÿè”åŠ¨ |

---

## ç¬¬äº”éƒ¨åˆ†ï¼šåºŸå¼ƒä»£ç æ¸…å•

| æ–‡ä»¶/ç±» | åºŸå¼ƒçŠ¶æ€ | è¯´æ˜ |
|---------|---------|------|
| `CropManager.cs` | æ•´ä¸ªç±» `[Obsolete]` | å·²è¢« CropController ç›´æ¥å®ä¾‹åŒ–æ›¿ä»£ |
| `CropInstance.cs` | æ•´ä¸ªç±» `[Obsolete]` | å·²è¢« CropInstanceData + CropController æ›¿ä»£ |
| `LayerTilemaps.farmlandTilemap` | `[Obsolete]` + `[HideInInspector]` | å·²è¢« farmlandCenterTilemap æ›¿ä»£ |
| `LayerTilemaps.waterPuddleTilemap` | `[Obsolete]` + `[HideInInspector]` | å·²è¢« waterPuddleTilemapNew æ›¿ä»£ |
| `SeedData.needsWatering` | `[Obsolete]` | å·²è¿ç§»åˆ° CropController |
| `CropData.seedID` | `[Obsolete]` | æ•°æ®æµæ”¹ä¸ºå•å‘ |
| `CropData.witheredCropID` | `[Obsolete]` | æ•°æ®æµæ”¹ä¸ºå•å‘ |
| `CropData.harvestExp` | `[Obsolete]` | ç»éªŒå€¼ç»Ÿä¸€å½’ SeedData |
| `WitheredCropData.seedID` | `[Obsolete]` | æ•°æ®æµæ”¹ä¸ºå•å‘ |
| `FarmTileSaveData` æ—§ä½œç‰©å­—æ®µ | `[Obsolete]` | cropId/cropGrowthStage/cropQuality/daysGrown/daysWithoutWater |

---

## ç¬¬å…­éƒ¨åˆ†ï¼š10.1.0 å…¨é¢æŒä¹…åŒ–å»ºè®®

### å¿…é¡»ä¿®å¤ï¼ˆP0ï¼‰
1. FarmTileSaveData è¡¥å…¨ 3 ä¸ªç¼ºå¤±å­—æ®µï¼ˆwateredYesterday/waterTime/puddleVariantï¼‰
2. FarmTileManager.Save() å’Œ CreateTileFromSaveData() é€‚é…æ–°å­—æ®µ
3. æ—§å­˜æ¡£å…¼å®¹ï¼šæ–°å­—æ®µä½¿ç”¨é»˜è®¤å€¼ï¼ˆwateredYesterday=false, waterTime=-1f, puddleVariant=0ï¼‰

### å»ºè®®åŒæ­¥å¤„ç†ï¼ˆP1ï¼‰
4. è¯„ä¼°æ˜¯å¦åœ¨ 10.1.0 ä¸­ä¸€å¹¶å®ç° 9.0.4 æ™ºèƒ½äº¤äº’
5. è¯„ä¼°æ˜¯å¦åœ¨ 10.1.0 ä¸­é›†æˆ Collect åŠ¨ç”»

### æµ‹è¯•é‡ç‚¹
6. å­˜æ¡£/è¯»æ¡£å®Œæ•´æ€§ï¼šè€•åœ°æµ‡æ°´çŠ¶æ€ã€ä½œç‰©ç”Ÿé•¿é˜¶æ®µã€ä½œç‰©ä½ç½®å…³è”
7. æ—¥ç»“æµç¨‹ï¼šæµ‡æ°´ â†’ ç¬¬äºŒå¤©ç”Ÿé•¿ â†’ æˆç†Ÿ â†’ è¿‡ç†Ÿæ¯è
8. æ’­ç§é“¾è·¯ï¼šç§å­è¢‹ â†’ é¢„è§ˆ â†’ æ’­ç§ â†’ ä½œç‰©å®ä¾‹åŒ–
9. æ”¶è·é“¾è·¯ï¼šæˆç†Ÿä½œç‰© â†’ æ‰è½ç‰©å“ â†’ è€•åœ°æ¸…ç†


---

## ç¬¬ä¸ƒéƒ¨åˆ†ï¼šç”¨æˆ·è¡¥å…… Bug ä¸éœ€æ±‚åˆ†æï¼ˆ2026-02-15 è¡¥å……ï¼‰

### Bug 1aï¼šè€•åœ°åŠ¨ç”»æ’­æ”¾ä¸­è¿ç»­ç‚¹å‡»å¤±æ•ˆ

**ç°è±¡**: æ‰‹æŒé”„å¤´ï¼Œè€•åœ°åŠ¨ç”»æœªå®Œæˆæ—¶å†æ¬¡ç‚¹å‡»å…¶ä»–ä½ç½®ï¼Œç©å®¶åŸåœ°æ’­æ”¾é”„åœ°åŠ¨ç”»ä½†ä¸ä¼šèµ°å»å…¶ä»–ä½ç½®è€•åœ°ï¼Œéœ€è¦ç­‰åŠ¨ç”»ç»“æŸå†é‡æ–°ç‚¹å‡»æ‰èƒ½æ­£ç¡®æ‰§è¡Œã€‚

**æ ¹å› **: `HandleUseCurrentTool` ç¬¬ 654 è¡Œ

```csharp
bool isPerformingAction = playerInteraction != null && playerInteraction.IsPerformingAction();
if (isPerformingAction) return;
```

åŠ¨ç”»æ’­æ”¾æœŸé—´ `IsPerformingAction()` è¿”å› trueï¼Œæ•´ä¸ªæ–¹æ³•ç›´æ¥ returnï¼Œ`TryTillSoil` éƒ½è¿›ä¸å»ã€‚æ‰€æœ‰ç‚¹å‡»è¢«åæ‰ã€‚

**é—®é¢˜å®šæ€§**: è¿‡åº¦ä¿æŠ¤ â€” å¯¹ç æ ‘/æ”»å‡»åˆç†ï¼ˆé˜²è¿ç»­æ”»å‡»ï¼‰ï¼Œä½†å†œç”°å·¥å…·åº”å…è®¸"æ‰“æ–­å½“å‰åŠ¨ç”»ï¼Œæ‰§è¡Œæ–°æ“ä½œ"ã€‚

**ä¿®å¤æ–¹å‘**: å†œç”°å·¥å…·ï¼ˆHoe/WateringCanï¼‰åˆ†æ”¯åº”åœ¨ `IsPerformingAction()` æ£€æŸ¥ä¹‹å‰å¤„ç†ï¼Œæˆ–å¯¹å†œç”°å·¥å…·è·³è¿‡æ­¤æ£€æŸ¥ã€‚

---

### Bug 1bï¼šå¯¼èˆªé€”ä¸­ç‚¹å‡» B ç‚¹ï¼Œé¢„è§ˆä¸æ›´æ–°

**ç°è±¡**: å…ˆå·¦é”® A åœ°è¿›è¡Œé”„åœ°ï¼ˆéœ€å¯¼èˆªï¼‰ï¼Œå¯¼èˆªé€”ä¸­ç‚¹å‡» B ç‚¹ï¼Œé¢„è§ˆä»æ˜¾ç¤ºåœ¨ A ç‚¹ï¼Œä½†å®é™…è€•å‡ºæ¥çš„æ˜¯ B ç‚¹ã€‚

**æ ¹å› **: `HandleUseCurrentTool` ç¬¬ 622-639 è¡Œ

å¯¼èˆªä¸­é‡æ–°ç‚¹å‡»æ—¶ï¼Œ`CancelFarmingNavigation()` è§£é”æ—§é¢„è§ˆ â†’ åŒä¸€å¸§å†… `TryTillSoil` è¯»å–å®æ—¶æ•°æ®ï¼ˆB ç‚¹ï¼‰â†’ ç«‹å³é”å®šåˆ° B ç‚¹ã€‚é¢„è§ˆè§†è§‰æ²¡æœ‰æœºä¼šæ›´æ–°åˆ° B ç‚¹çš„"é¼ æ ‡è·Ÿéš"çŠ¶æ€å°±è¢«å†æ¬¡é”å®šã€‚

**æ—¶åºåˆ†æ**:
```
åŒä¸€å¸§å†…ï¼š
1. UpdatePreviews() â†’ _isLocked=true â†’ å®æ—¶æ•°æ®æ›´æ–°åˆ°é¼ æ ‡ä½ç½®ï¼ˆBç‚¹ï¼‰ï¼Œä½†è§†è§‰å†»ç»“åœ¨ A ç‚¹
2. HandleUseCurrentTool() â†’ CancelFarmingNavigation() â†’ è§£é”
3. TryTillSoil() â†’ è¯»å–å®æ—¶æ•°æ®ï¼ˆBç‚¹ï¼‰â†’ é”å®šåˆ° B ç‚¹
ç»“æœï¼šé¢„è§ˆä» A ç‚¹ç›´æ¥è·³åˆ° B ç‚¹çš„é”å®šçŠ¶æ€ï¼Œæ²¡æœ‰"è·Ÿéšé¼ æ ‡"çš„è§†è§‰è¿‡æ¸¡
```

**ä¿®å¤æ–¹å‘**: é‡æ–°ç‚¹å‡»æ—¶ï¼Œéœ€è¦å…ˆè®©é¢„è§ˆæ›´æ–°ä¸€å¸§åˆ°é¼ æ ‡ä½ç½®ï¼ˆB ç‚¹ï¼‰ï¼Œå†é”å®šã€‚æˆ–è€…åœ¨é”å®šæ—¶å¼ºåˆ¶æ›´æ–°ä¸€æ¬¡è§†è§‰åˆ°æ–°ä½ç½®ã€‚

---

### Bug 2ï¼šæµ‡æ°´æ°´æ¸ä¸æ˜¾ç¤º

**ç°è±¡**: æµ‡æ°´é€»è¾‘æ­£ç¡®ï¼ˆæµ‡è¿‡æ°´çš„ä¸èƒ½å†æµ‡ï¼Œåªèƒ½å¯¹è€•åœ°æµ‡ï¼Œæµ‡æ°´ä¼šå¯¼èˆªï¼‰ï¼Œä½†çœ‹ä¸åˆ°æ°´æ¸ã€‚

**æ ¹å› **: `FarmVisualManager.UpdateTileVisual()` ä¸­

```csharp
Tilemap puddleTilemap = tilemaps.waterPuddleTilemapNew;
```

`waterPuddleTilemapNew` æ˜¯ 9.0.5 ä¼šè¯ 7 æ–°å¢çš„å­—æ®µï¼Œéœ€è¦åœ¨ Inspector ä¸­ä¸ºæ¯ä¸ªæ¥¼å±‚çš„ `LayerTilemaps` é…ç½®æ­¤å­—æ®µã€‚å¦‚æœæœªé…ç½®ï¼Œå›é€€åˆ°æ—§çš„ `waterPuddleTilemap`ï¼ˆå·² Obsoleteï¼‰ï¼Œå¦‚æœæ—§çš„ä¹Ÿæ˜¯ nullï¼Œåˆ™æ°´æ¸ä¸æ˜¾ç¤ºã€‚

**ç¡®è®¤æ–¹å¼**: æ£€æŸ¥åœºæ™¯ä¸­ LayerTilemaps ç»„ä»¶çš„ `waterPuddleTilemapNew` å­—æ®µæ˜¯å¦å·²èµ‹å€¼ã€‚

**ç”¨æˆ·å»ºè®®**: å°† water tile æ”¾å…¥ TileManager ç»Ÿä¸€ç®¡ç†ã€‚å½“å‰æ°´æ¸ Tile èµ„æºåœ¨ `FarmVisualManager.wetPuddleTiles` æ•°ç»„ä¸­ï¼ŒTilemap å¼•ç”¨åœ¨ `LayerTilemaps` ä¸­ï¼Œé…ç½®åˆ†æ•£ã€‚

---

### Bug 2 è¡¥å……ï¼šæµ‡æ°´çš„äº¤äº’é€šç—…

`TryWaterTile` ä¸ `TryTillSoil` ä»£ç ç»“æ„å®Œå…¨ä¸€è‡´ï¼ŒåŒæ ·å—ä»¥ä¸‹é—®é¢˜å½±å“ï¼š
- `IsPerformingAction()` è¿‡åº¦ä¿æŠ¤ï¼ˆBug 1a é€šç—…ï¼‰
- å¯¼èˆªä¸­é‡æ–°ç‚¹å‡»çš„é¢„è§ˆä¸æ›´æ–°ï¼ˆBug 1b é€šç—…ï¼‰

---

### é—®é¢˜ 3ï¼šäº¤äº’é€»è¾‘é€šç—…æ€»ç»“

**ä¸¤ä¸ªæ ¹å› **:

| # | æ ¹å›  | å½±å“èŒƒå›´ | ä¸¥é‡ç¨‹åº¦ |
|---|------|---------|---------|
| R1 | `IsPerformingAction()` è¿‡åº¦ä¿æŠ¤ | é”„å¤´/æ°´å£¶/ç§å­ | P0 â€” è¿ç»­æ“ä½œå¤±æ•ˆ |
| R2 | åŒå¸§è§£é”+é‡é”å¯¼è‡´é¢„è§ˆè·³å˜ | æ‰€æœ‰å¯¼èˆªä¸­é‡æ–°ç‚¹å‡»åœºæ™¯ | P1 â€” è§†è§‰ä¸ä¸€è‡´ |

**ä¿®å¤æ–¹å‘**:

R1 ä¿®å¤æ€è·¯ï¼š
- æ–¹æ¡ˆ Aï¼šå†œç”°å·¥å…·åˆ†æ”¯æå‰åˆ° `IsPerformingAction()` æ£€æŸ¥ä¹‹å‰
- æ–¹æ¡ˆ Bï¼šå¯¹å†œç”°å·¥å…·è·³è¿‡ `IsPerformingAction()` æ£€æŸ¥ï¼Œæ”¹ç”¨ `_isExecutingFarming` ä¿æŠ¤
- æ¨èæ–¹æ¡ˆ B â€” æœ€å°æ”¹åŠ¨ï¼Œ`_isExecutingFarming` å·²ç»æ˜¯åŒæ­¥ä¿æŠ¤ï¼Œè¶³å¤Ÿé˜²æ­¢é‡å¤æ‰§è¡Œ

R2 ä¿®å¤æ€è·¯ï¼š
- æ–¹æ¡ˆ Aï¼šé‡æ–°ç‚¹å‡»æ—¶ï¼Œåœ¨é”å®šå‰å¼ºåˆ¶è°ƒç”¨ä¸€æ¬¡ `UpdateHoePreview` çš„è§†è§‰æ›´æ–°ï¼ˆä¼ å…¥æ–°ä½ç½®ï¼‰
- æ–¹æ¡ˆ Bï¼š`LockPosition` æ–¹æ³•å†…éƒ¨è‡ªåŠ¨æ›´æ–°ä¸€æ¬¡è§†è§‰åˆ°é”å®šä½ç½®
- æ¨èæ–¹æ¡ˆ B â€” é”å®šæ—¶è‡ªåŠ¨åˆ·æ–°è§†è§‰ï¼Œä¿è¯é”å®šä½ç½®å’Œè§†è§‰ä¸€è‡´

**ä»£åŠ**: ç¡®å®šä¿®å¤æ–¹æ¡ˆåï¼Œå°†"å†œç”°å·¥å…·åŠ¨ç”»ä¿æŠ¤è§„åˆ™"å’Œ"é¢„è§ˆé”å®šè§†è§‰åŒæ­¥è§„åˆ™"å†™å…¥ steering è§„åˆ™ï¼Œå…¨å±€ç®¡æ§ã€‚
