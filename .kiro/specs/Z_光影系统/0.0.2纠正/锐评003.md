你说得完全正确，我必须向你道歉！跳过设计文档直接让它写代码确实是非常糟糕的习惯，这不仅违背了你项目里 `rules.md` 中“先设计后实现”的核心红线，也确实让我这个“架构师”失去了把关的意义。你的批评非常中肯，**从现在起，我将严格遵守“必须先出设计、审核通过再执行代码”的全局规则，绝对不再妥协。**

关于你发现的这个“睡醒后依然是黑夜，过十分钟才天亮”的畸形 Bug，我一眼就看穿了它的底层逻辑漏洞：
**Bug 的根源在于数据缓存的滞后。** 在 `DayNightManager` 中，`cachedDayProgress` 这个控制颜色的核心变量，**只有在 `OnMinuteChanged`（每 10 分钟跳动一次）时才会更新**。当玩家触发 `Sleep()` 瞬间，时间变成了 06:00，但 `DayNightManager` 并没有立刻去重新获取 `dayProgress`，导致它用的还是睡觉前（比如深夜 02:00）的暗色数据。直到 06:10 触发了第一次分钟变化，它才如梦初醒般把颜色切回白天。

现在，让我们严格按照标准流程，把这个 Bug 的修复、颜色曲线的调整以及视线收缩的方案，全部打包成一个**要求它先出设计文档**的强力 Prompt。

请你直接复制以下这段话发送给 Kiro：

---

**【强制架构指令：停止写代码，先出设计文档】**

Kiro，你的分析方向是对的，但是你的执行流程违背了我们的核心规则 `rules.md` 中的“先设计后实现”。并且，目前的系统还隐藏着一个严重的逻辑 Bug，需要你一并纳入设计中。

**现存在严重 Bug（睡觉光影滞后）：**
当我按下右方向键或 `+` 号触发 `Sleep()` 跨天时，游戏时间立刻变为 06:00，**但屏幕依然是黑夜的颜色**！直到 06:10 触发 `OnMinuteChanged` 时，屏幕才突然变亮。
**架构师诊断：** 这是因为 `DayNightManager` 中的 `cachedDayProgress` 没有在 `OnSleep` 时同步更新。睡觉瞬间使用的仍是旧的进度数据。

**现在，我要求你针对以下三点，输出一份详细的模块设计方案（追加到 `design.md` 或作为独立提案），未经我审核同意，绝对不允许编写或修改任何系统代码！**

1. **Bug 修复方案（光影滞后）：**
设计如何在跨天/睡眠（`OnSleep`）时，立即强制刷新 `cachedDayProgress` 和目标颜色，确保过渡动画的目标颜色是 06:00 的清晨亮色，而不是等到 06:10 才反应过来。
2. **颜色曲线修正方案：**
设计在 `DayNightConfigCreator.cs` 中，如何在 `dayProgress = 0.50` (16:00) 处补充平台期节点，确保 12:00 到 16:00 期间亮度保持正午状态。
3. **夜间视线收缩系统（Night Vision Mask）设计：**
* **渲染层：** 详细说明 `NightVisionMask.shader` 的工作原理（如何实现径向渐变，如何与底层解耦）。
* **逻辑层：** 详细说明 `NightVisionController.cs` 的设计。它应该如何根据时间（19:00 - 02:00）计算半径缩放？如何确保光圈**永远以玩家的 `Collider` 中心（bounds.center）**为原点，而不是摄像机中心？
* **开关层：** 如何接入现有的调试禁用开关。



请你立即输出这份设计文档的草案大纲与核心逻辑说明。记住，**不准直接修改项目代码，先给我看设计！**

---

发给它之后，把它生成的设计方案直接粘贴给我，我会用最严苛的标准帮你审查，确认逻辑无懈可击后，我们再放权让它去写代码！准备好发给我了吗？