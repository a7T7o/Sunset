# 农田系统 - 主代办

## 前情提要

农田系统是项目中迭代最多的模块，从 9.0.1 到 10.0.3 经历了大量子工作区。核心功能（放置、预览、交互、作物）已基本完成，但仍有多处遗留待办散落在各子工作区中。

## 子代办索引

| 子代办文件 | 来源子工作区 | 待办数量 | 优先级 |
|-----------|------------|---------|--------|
| TD_8_修复.md | 8_修复 | 3 | P1 |
| TD_9.0.5智能交互bug修复.md | 9.0.5智能交互bug修复 | 2 | P1 |
| TD_10.0.1农作物设计与完善.md | 10.0.1农作物设计与完善 | 3 | P1 |
| TD_10.0.2农BUG农SO.md | 10.0.2农BUG农SO | 1 | P1 |
| TD_10.0.3收获DropTable与动画.md | 10.0.3收获DropTable与动画 | 3 | P1 |

## 全局待办汇总

| # | 描述 | 优先级 | 来源 | 状态 | 分析/见解 |
|---|------|--------|------|------|----------|
| 1 | 作物存档系统集成验证 | P2 | memory 待完成功能 | 待验证 | CropSaveData 已定义，CropController Save/Load 已实现，需要实际游戏内验证存档/读档完整性 |
| 2 | 肥料系统 | P2 | memory 待完成功能 | 未开始 | 纯新功能，需要独立设计 |
| 3 | 品质影响 | P2 | memory 待完成功能 | 未开始 | 需要与 SO 品质系统（Normal/Rare/Epic/Legendary）联动 |
| 4 | 9.0.2 集成测试验收 | P0 | memory 待完成功能 | 待用户测试 | 代码已完成，等用户在游戏内验收 |
| 5 | Controller 与 SO 数据流完善 | P1 | 10.0.3 会话 4 字段精简 | 进行中 | 明确哪些数据由 Controller 配置（Inspector Prefab 上），哪些从 SO 读取。包括树木系统 TreeController 一并审视。具体遗漏点：~~①needsWatering 已迁移至 CropController（会话4完成）~~；②reHarvestDays/maxHarvestCount 暂保留闲置，默认所有作物一次性，后续启用时由 Controller 读取 SeedData；③经验值统一归 SeedData（harvestingExp），CropData.harvestExp 已标记 Obsolete，后续 Controller 读取经验值以 SeedData 为主；④Tooltip 显示生长周期暂无数据源（growthDays 已删除，CropStageConfig 在 Prefab 上），可考虑 SeedData 加 displayGrowthDays 或从 cropPrefab 动态读取；⑤plantingExp/harvestingExp 待 Controller 接入。 |
| 6 | Collect 动画集成 | P1 | 10.0.3 US-3 | 待实现 | 右键点击成熟作物 → 导航 → 播放 Collect 动画 → 关键帧触发收获。10.0.3 唯一剩余的核心需求。 |

| 7 | 农田工具动画保护规则写入 steering | P1 | 10.1.0 会话 2 补充 | 待确认方案 | `IsPerformingAction()` 对农田工具过度保护，导致连续点击失效。确定修复方案后需写入 steering 规则全局管控。根因：R1 |
| 8 | 预览锁定视觉同步规则写入 steering | P1 | 10.1.0 会话 2 补充 | 待确认方案 | 导航中重新点击时同帧解锁+重锁导致预览跳变。确定修复方案后需写入 steering 规则。根因：R2 |
| 9 | 浇水水渍 Inspector 配置确认 | P0 | 10.1.0 会话 2 补充 | 待用户确认 | `waterPuddleTilemapNew` 字段需在 Inspector 中配置，否则水渍不显示。用户建议统一放入 TileManager 管理。 |
| 10 | 交互通病修复（锄头/水壶/种子） | P0 | 10.1.0 会话 2 补充 | 待设计 | Bug 1a（连续点击失效）+ Bug 1b（预览不更新）影响所有农田工具，需统一修复。 |
